import math
import collections
from collections import Counter
import re
from tqdm import tqdm

# from termcolor import colored

PROD = """
#############################################################################################################################################
#...###...#####.....#.........#...#####...#...###...........###...#.....#.......#.......###.....#.....###.......#...###.......#...#...#.....#
#.#.###.#.#####.###.#.#######.#.#.#####.#.#.#.###.#########.###.#.#.###.#.#####.#.#####.###.###.#.###.###.#####.#.#.###.#####.#.#.#.#.#.###.#
#.#.#...#...#...#...#.......#.#.#...#...#.#.#...#.........#.#...#.#...#.#.#.....#.....#...#...#.#.#...#...#...#.#.#.#...#.....#.#...#...#...#
#.#.#.#####.#.###.#########.#.#.###.#.###.#.###.#########.#.#.###.###.#.#.#.#########.###.###.#.#.#.###.###.#.#.#.#.#.###.#####.#########.###
#.#...#.....#...#...#.....#.#.#.#...#...#...#...#.....###.#.#.#...#...#...#.....#.....#...#...#.#.#...#.#...#...#.#.#...#.....#.#...#.....###
#.#####.#######.###.#.###.#.#.#.#.#####.#####.###.###.###.#.#.#.###.###########.#.#####.###.###.#.###.#.#.#######.#.###.#####.#.#.#.#.#######
#.....#.#.......#...#...#.#.#.#.#.#...#.....#...#...#.#...#.#.#.....#...........#.....#...#...#.#.#...#.#...###...#...#.#.....#...#.#.......#
#####.#.#.#######.#####.#.#.#.#.#.#.#.#####.###.###.#.#.###.#.#######.###############.###.###.#.#.#.###.###.###.#####.#.#.#########.#######.#
#.....#...#.....#.#.....#.#.#.#.#.#.#.#...#.#...###.#.#...#...#.......#.......#...#...#...#...#...#.###...#...#.....#.#.#.#...###...#.......#
#.#########.###.#.#.#####.#.#.#.#.#.#.#.#.#.#.#####.#.###.#####.#######.#####.#.#.#.###.###.#######.#####.###.#####.#.#.#.#.#.###.###.#######
#...........###.#.#.....#.#.#...#.#.#.#.#.#.#.###...#.###.....#.###...#...#...#.#...#...#...#.......#...#.#...#...#.#.#.#.#.#...#...#.......#
###############.#.#####.#.#.#####.#.#.#.#.#.#.###.###.#######.#.###.#.###.#.###.#####.###.###.#######.#.#.#.###.#.#.#.#.#.#.###.###.#######.#
#...#...........#.#...#.#.#...#...#.#.#.#.#.#.#...#...#.......#...#.#...#.#...#.....#.###...#.#.....#.#.#.#...#.#...#...#...#...#...#.......#
#.#.#.###########.#.#.#.#.###.#.###.#.#.#.#.#.#.###.###.#########.#.###.#.###.#####.#.#####.#.#.###.#.#.#.###.#.#############.###.###.#######
#.#.#...........#...#.#.#.#...#.#...#...#...#.#.#...###.......#...#.#...#.#...#.....#...#...#.#.#...#.#.#...#.#.....#.......#...#.#...###...#
#.#.###########.#####.#.#.#.###.#.###########.#.#.###########.#.###.#.###.#.###.#######.#.###.#.#.###.#.###.#.#####.#.#####.###.#.#.#####.#.#
#.#...#...#.....#...#...#.#...#.#.#.........#...#.......#.....#.###.#...#.#...#.....#...#...#...#...#.#.#...#...#...#.....#.....#.#.#...#.#.#
#.###.#.#.#.#####.#.#####.###.#.#.#.#######.###########.#.#####.###.###.#.###.#####.#.#####.#######.#.#.#.#####.#.#######.#######.#.#.#.#.#.#
#...#.#.#.#.......#.....#...#.#.#...#.....#.#.....#.....#.....#...#.#...#.#...#.....#...###.....#...#.#.#...#...#...#.....###.....#.#.#.#.#.#
###.#.#.#.#############.###.#.#.#####.###.#.#.###.#.#########.###.#.#.###.#.###.#######.#######.#.###.#.###.#.#####.#.#######.#####.#.#.#.#.#
#...#.#.#.#...........#...#.#.#.#...#.#...#...#...#...###...#.#...#.#.#...#.###.....#...#...#...#...#.#.#...#.#...#.#.###...#.#.....#.#...#.#
#.###.#.#.#.#########.###.#.#.#.#.#.#.#.#######.#####.###.#.#.#.###.#.#.###.#######.#.###.#.#.#####.#.#.#.###.#.#.#.#.###.#.#.#.#####.#####.#
#...#.#.#.#.........#.###.#.#.#...#.#.#.....#...#...#...#.#...#...#.#.#...#...###...#.....#.#...#...#.#.#...#.#.#.#.#.....#...#.......#...#.#
###.#.#.#.#########.#.###.#.#.#####.#.#####.#.###.#.###.#.#######.#.#.###.###.###.#########.###.#.###.#.###.#.#.#.#.###################.#.#.#
#...#...#.###.......#...#.#.#.....#.#.#.....#.....#.#...#.......#...#...#.#...#...#...#...#.#...#...#.#...#.#.#.#...#...#...#.....#.....#...#
#.#######.###.#########.#.#.#####.#.#.#.###########.#.#########.#######.#.#.###.###.#.#.#.#.#.#####.#.###.#.#.#.#####.#.#.#.#.###.#.#########
#.......#.....#.......#.#.#.#...#.#...#...#...#.....#.....###...#.......#.#.###...#.#.#.#...#...#...#...#.#.#.#.#.....#...#.#...#.#.........#
#######.#######.#####.#.#.#.#.#.#.#######.#.#.#.#########.###.###.#######.#.#####.#.#.#.#######.#.#####.#.#.#.#.#.#########.###.#.#########.#
#.....#.#...#...#.....#...#.#.#.#.....#...#.#.#...#.....#.#...#...###...#.#.#...#.#.#...###.....#.....#.#.#.#.#.#.........#.....#.#.......#.#
#.###.#.#.#.#.###.#########.#.#.#####.#.###.#.###.#.###.#.#.###.#####.#.#.#.#.#.#.#.#######.#########.#.#.#.#.#.#########.#######.#.#####.#.#
#.#...#...#.#.#...#.......#.#.#.#...#.#...#.#...#...#...#.#...#.#...#.#.#.#.#.#.#.#.#...#...#...#.....#.#.#.#...#...#...#...#...#...#...#...#
#.#.#######.#.#.###.#####.#.#.#.#.#.#.###.#.###.#####.###.###.#.#.#.#.#.#.#.#.#.#.#.#.#.#.###.#.#.#####.#.#.#####.#.#.#.###.#.#.#####.#.#####
#.#...#...#...#.....###...#...#.#.#.#.#...#.#...#...#...#.###.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...#...#...#.#.#.#...#.#...#.....#.#.......#...###
#.###.#.#.#############.#######.#.#.#.#.###.#.###.#.###.#.###.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#######.#.#.#.#.#.#.#.###########.###########.###
#...#.#.#.#...#...#...#...#...#...#...#.....#.#...#.#...#.#...#.#.#.#.#.#.#.#.#...#.#.#...#.#...#...#.#.#...#.#.#.......#.....#.....#...#...#
###.#.#.#.#.#.#.#.#.#.###.#.#.###############.#.###.#.###.#.###.#.#.#.#.#.#.#.#####.#.#####.#.#.#.###.#.#####.#.#######.#.#####.###.#.#.###.#
###.#...#...#...#...#...#...#...............#.#.###.#...#...#...#.#.#.#.#.#.#.....#.#.###...#.#.#...#.#.#.....#.......#.#.#.....###...#.....#
###.###################.###################.#.#.###.###.#####.###.#.#.#.#.#.#####.#.#.###.###.#.###.#.#.#.###########.#.#.#.#################
#...#.......#.....#...#.................#...#.#.#...#...#...#.....#...#.#.#.#...#.#.#.#...#...#...#.#.#.#.#.........#...#.#.....#...#...#...#
#.###.#####.#.###.#.#.#################.#.###.#.#.###.###.#.###########.#.#.#.#.#.#.#.#.###.#####.#.#.#.#.#.#######.#####.#####.#.#.#.#.#.#.#
#.#...#.....#...#.#.#.#...#.....#.....#.#...#...#...#.....#.......###...#.#.#.#...#.#.#...#...###...#...#...#...#...###...#...#...#...#...#.#
#.#.###.#######.#.#.#.#.#.#.###.#.###.#.###.#######.#############.###.###.#.#.#####.#.###.###.###############.#.#.#####.###.#.#############.#
#.#...#...#.....#...#...#...###...#...#.#...#.......#...#...#.....#...#...#.#...#...#.#...#...#...#...#.......#...#...#...#.#.....#.....#...#
#.###.###.#.#######################.###.#.###.#######.#.#.#.#.#####.###.###.###.#.###.#.###.###.#.#.#.#.###########.#.###.#.#####.#.###.#.###
#.#...###.#.###...#...#.............###.#...#.......#.#.#.#.#...###...#...#...#.#.#...#...#...#.#...#.#.......#.....#.....#.....#...#...#...#
#.#.#####.#.###.#.#.#.#.###############.###.#######.#.#.#.#.###.#####.###.###.#.#.#.#####.###.#.#####.#######.#.###############.#####.#####.#
#.#.#.....#.#...#...#...#.....#.......#.....#.......#.#...#...#.....#.#...###...#...###...#...#.#...#.........#.#...............#...#.......#
#.#.#.#####.#.###########.###.#.#####.#######.#######.#######.#####.#.#.###############.###.###.#.#.###########.#.###############.#.#########
#.#.#...#...#.....#...#...###...#.....#.....#.#...#...###.....#...#.#.#...###.......#...#...###...#...#.........#...............#.#...#.....#
#.#.###.#.#######.#.#.#.#########.#####.###.#.#.#.#.#####.#####.#.#.#.###.###.#####.#.###.###########.#.#######################.#.###.#.###.#
#...###...#...#...#.#...#...#...#.......#...#.#.#.#.....#...#...#...#...#...#.#...#...#...#.........#...#.....#...#.............#.#...#.#...#
###########.#.#.###.#####.#.#.#.#########.###.#.#.#####.###.#.#########.###.#.#.#.#####.###.#######.#####.###.#.#.#.#############.#.###.#.###
###...#...#.#.#.....#.....#...#.......#...###...#.......#...#.#...#.....#...#...#...#...###.#.....#.......###...#...#...........#.#.....#...#
###.#.#.#.#.#.#######.###############.#.#################.###.#.#.#.#####.#########.#.#####.#.###.###################.#########.#.#########.#
#...#...#.#.#.#...###...#...#.......#.#.....#.....#...###...#...#.#.#.....#########...###...#...#.........###...#...#.#.......#...#.......#.#
#.#######.#.#.#.#.#####.#.#.#.#####.#.#####.#.###.#.#.#####.#####.#.#.###################.#####.#########.###.#.#.#.#.#.#####.#####.#####.#.#
#.......#.#.#.#.#.#...#...#...#.....#.......#...#...#.....#.#...#.#.#.###################.......#...#...#.....#...#...#.....#...#...###...#.#
#######.#.#.#.#.#.#.#.#########.###############.#########.#.#.#.#.#.#.###########################.#.#.#.###################.###.#.#####.###.#
#.......#...#...#...#.........#...............#.#.........#.#.#.#.#.#...#######################...#...#.......#.............###...#...#.....#
#.###########################.###############.#.#.#########.#.#.#.#.###.#######################.#############.#.###################.#.#######
#.....#...#...#.......#.....#.#...#...........#.#.........#...#.#.#.#...#######################.............#.#.............#.......#.......#
#####.#.#.#.#.#.#####.#.###.#.#.#.#.###########.#########.#####.#.#.#.#####################################.#.#############.#.#############.#
#.....#.#...#...#...#...#...#...#...#...#...###.#.........#...#.#.#.#.#########################.............#.....#...#...#...#...........#.#
#.#####.#########.#.#####.###########.#.#.#.###.#.#########.#.#.#.#.#.#########################.#################.#.#.#.#.#####.#########.#.#
#...#...#.........#.......#...#.....#.#...#...#.#.....###...#.#.#.#.#.#########################...............###...#.#.#.......#...#...#...#
###.#.###.#################.#.#.###.#.#######.#.#####.###.###.#.#.#.#.#######################################.#######.#.#########.#.#.#.#####
#...#...#.....#...........#.#...###...#.....#...#...#...#.#...#.#.#.#.#######################################...#...#...#.........#...#.....#
#.#####.#####.#.#########.#.###########.###.#####.#.###.#.#.###.#.#.#.#########################################.#.#.#####.#################.#
#.......#.....#.#.......#...#...........#...#...#.#.#...#.#.###...#.#.#####################...#...#...#######S..#.#.#.....#.................#
#########.#####.#.#####.#####.###########.###.#.#.#.#.###.#.#######.#.#####################.#.#.#.#.#.###########.#.#.#####.#################
#...#.....#...#.#.#...#.....#.........###...#.#.#.#.#.....#.....#...#...#######....E###...#.#.#.#...#.......#...#.#...#...#.................#
#.#.#.#####.#.#.#.#.#.#####.#########.#####.#.#.#.#.###########.#.#####.#######.#######.#.#.#.#.###########.#.#.#.#####.#.#################.#
#.#.#.......#...#...#.....#.#.........#...#...#...#.#...#.......#...#...###...#.........#...#...#...#.......#.#.#.#...#.#.#...........#...#.#
#.#.#####################.#.#.#########.#.#########.#.#.#.#########.#.#####.#.###################.#.#.#######.#.#.#.#.#.#.#.#########.#.#.#.#
#.#.###...#.......###...#.#.#...#...###.#...#.....#...#.#.......#...#.###...#.#...#...#...#.....#.#.#.........#...#.#...#.#.....#...#...#...#
#.#.###.#.#.#####.###.#.#.#.###.#.#.###.###.#.###.#####.#######.#.###.###.###.#.#.#.#.#.#.#.###.#.#.###############.#####.#####.#.#.#########
#.#.#...#.#...#...#...#...#...#...#.....#...#.#...#...#.........#...#.#...#...#.#.#.#...#.#...#.#.#.#...#.....#...#.....#.......#.#.###.....#
#.#.#.###.###.#.###.#########.###########.###.#.###.#.#############.#.#.###.###.#.#.#####.###.#.#.#.#.#.#.###.#.#.#####.#########.#.###.###.#
#.#...#...#...#.....#...#...#...........#.....#...#.#.###.........#...#...#.#...#.#.....#.....#...#...#...#...#.#.....#...........#.....#...#
#.#####.###.#########.#.#.#.###########.#########.#.#.###.#######.#######.#.#.###.#####.###################.###.#####.###################.###
#.#...#...#...........#...#...........#.#.......#...#...#.#.......#...#...#.#.#...###...#...#...#.....#...#.....#...#.#.....#.............###
#.#.#.###.###########################.#.#.#####.#######.#.#.#######.#.#.###.#.#.#####.###.#.#.#.#.###.#.#.#######.#.#.#.###.#.###############
#.#.#...#...........#...#.............#.#.....#...#.....#.#...#...#.#.#...#.#.#.###...#...#.#.#.#...#...#.....###.#.#...###.#...............#
#.#.###.###########.#.#.#.#############.#####.###.#.#####.###.#.#.#.#.###.#.#.#.###.###.###.#.#.###.#########.###.#.#######.###############.#
#...###...#...#...#...#...#...#.......#.#.....#...#.#...#...#...#...#.#...#.#.#...#...#.###...#.....#.........#...#.......#...#.............#
#########.#.#.#.#.#########.#.#.#####.#.#.#####.###.#.#.###.#########.#.###.#.###.###.#.#############.#########.#########.###.#.#############
#.....###...#...#...#...#...#.#.#.....#...#...#.....#.#.#...#...#.....#...#...#...#...#.#...#...#...#...........#...#.....###...#...........#
#.###.#############.#.#.#.###.#.#.#########.#.#######.#.#.###.#.#.#######.#####.###.###.#.#.#.#.#.#.#############.#.#.###########.#########.#
#...#.#.............#.#.#.#...#.#...........#...###...#.#.#...#...#...#...#.....###.....#.#...#...#.............#.#.#.......#.....#...#.....#
###.#.#.#############.#.#.#.###.###############.###.###.#.#.#######.#.#.###.#############.#####################.#.#.#######.#.#####.#.#.#####
#...#...#...#.........#...#.....###...#...#...#...#...#...#.#.....#.#.#...#...###...#...#...#.............#...#...#.........#.#.....#...#...#
#.#######.#.#.#####################.#.#.#.#.#.###.###.#####.#.###.#.#.###.###.###.#.#.#.###.#.###########.#.#.###############.#.#########.#.#
#.........#...#...###.......#.......#.#.#.#.#.....#...#.....#.#...#.#...#...#...#.#.#.#...#...#...#.......#.#...#.....###...#.#.#.........#.#
###############.#.###.#####.#.#######.#.#.#.#######.###.#####.#.###.###.###.###.#.#.#.###.#####.#.#.#######.###.#.###.###.#.#.#.#.#########.#
#.....#.........#...#...#...#.......#...#...###...#...#...#...#.#...#...###...#...#...#...#...#.#.#.........#...#.#...#...#...#...#...#...#.#
#.###.#.###########.###.#.#########.###########.#.###.###.#.###.#.###.#######.#########.###.#.#.#.###########.###.#.###.###########.#.#.#.#.#
#...#.#...........#.....#.....#...#.......###...#.#...#...#...#...#...#####...#.........#...#...#.#...#.......###.#...#.#.......#...#...#...#
###.#.###########.###########.#.#.#######.###.###.#.###.#####.#####.#######.###.#########.#######.#.#.#.#########.###.#.#.#####.#.###########
#...#.....#...###...........#.#.#.#.......#...#...#...#.....#.....#.#...#...#...#...#...#...#.....#.#.#...........#...#.#.....#...#...#.....#
#.#######.#.#.#############.#.#.#.#.#######.###.#####.#####.#####.#.#.#.#.###.###.#.#.#.###.#.#####.#.#############.###.#####.#####.#.#.###.#
#.......#...#.#...#.....#...#.#.#...#.....#.#...###...#.....###...#.#.#.#.#...###.#.#.#...#.#.#...#.#...#...#.....#.....#.....#.....#...#...#
#######.#####.#.#.#.###.#.###.#.#####.###.#.#.#####.###.#######.###.#.#.#.#.#####.#.#.###.#.#.#.#.#.###.#.#.#.###.#######.#####.#########.###
###...#.....#...#.#...#.#...#...#...#...#.#.#.#...#...#.###...#.#...#.#.#.#.#...#.#.#...#.#.#.#.#.#...#.#.#.#...#.#.....#.....#.#.....#...###
###.#.#####.#####.###.#.###.#####.#.###.#.#.#.#.#.###.#.###.#.#.#.###.#.#.#.#.#.#.#.###.#.#.#.#.#.###.#.#.#.###.#.#.###.#####.#.#.###.#.#####
#...#.......#...#.....#.....#.....#...#.#.#.#...#.#...#...#.#.#.#.#...#.#.#.#.#.#.#...#.#...#.#.#.#...#.#.#.....#...###.#.....#.#.###...#...#
#.###########.#.#############.#######.#.#.#.#####.#.#####.#.#.#.#.#.###.#.#.#.#.#.###.#.#####.#.#.#.###.#.#############.#.#####.#.#######.#.#
#...#...#...#.#...#.....#...#...#...#.#.#.#.#.....#.....#.#.#.#.#.#.#...#.#...#.#.#...#.....#.#.#.#.#...#...........#...#.......#...#...#.#.#
###.#.#.#.#.#.###.#.###.#.#.###.#.#.#.#.#.#.#.#########.#.#.#.#.#.#.#.###.#####.#.#.#######.#.#.#.#.#.#############.#.#############.#.#.#.#.#
#...#.#...#.#.###...###...#...#.#.#...#.#.#.#.#.....#...#.#.#.#.#...#.#...#...#...#.#...#...#.#.#...#...#.....#...#.#.#.......#...#...#...#.#
#.###.#####.#.###############.#.#.#####.#.#.#.#.###.#.###.#.#.#.#####.#.###.#.#####.#.#.#.###.#.#######.#.###.#.#.#.#.#.#####.#.#.#########.#
#...#.#.....#.#...............#.#.....#.#...#.#...#.#.#...#.#.#.#.....#.....#.###...#.#.#...#.#...#.....#...#.#.#...#.#.....#.#.#.#...#.....#
###.#.#.#####.#.###############.#####.#.#####.###.#.#.#.###.#.#.#.###########.###.###.#.###.#.###.#.#######.#.#.#####.#####.#.#.#.#.#.#.#####
###...#.....#.#...#.......#...#.#.....#.#.....#...#...#.#...#...#...#...#...#.#...#...#.#...#...#.#.#.....#.#.#.....#.....#.#...#.#.#.#...###
###########.#.###.#.#####.#.#.#.#.#####.#.#####.#######.#.#########.#.#.#.#.#.#.###.###.#.#####.#.#.#.###.#.#.#####.#####.#.#####.#.#.###.###
###.........#.###...###...#.#.#.#...#...#.#...#.#...#...#...###.....#.#...#.#.#...#.###.#.....#.#.#.#...#.#.#.#...#.....#...#...#.#.#...#...#
###.#########.#########.###.#.#.###.#.###.#.#.#.#.#.#.#####.###.#####.#####.#.###.#.###.#####.#.#.#.###.#.#.#.#.#.#####.#####.#.#.#.###.###.#
#...#...#...#.........#.....#.#.###.#.#...#.#.#...#.#.#.....#...#...#...###...###.#.#...#.....#...#.#...#...#...#.#...#.....#.#.#.#...#.....#
#.###.#.#.#.#########.#######.#.###.#.#.###.#.#####.#.#.#####.###.#.###.#########.#.#.###.#########.#.###########.#.#.#####.#.#.#.###.#######
#.#...#.#.#.#...#...#.#.......#.#...#.#...#.#.#...#.#...#...#.#...#.#...#.......#.#.#...#...###.....#.......#.....#.#.......#.#.#.....#.....#
#.#.###.#.#.#.#.#.#.#.#.#######.#.###.###.#.#.#.#.#.#####.#.#.#.###.#.###.#####.#.#.###.###.###.###########.#.#####.#########.#.#######.###.#
#.#.#...#.#.#.#...#.#.#.....#...#...#...#...#.#.#...###...#...#.###...#...#...#...#.###...#...#...#.....#...#.#...#...###...#.#.........#...#
#.#.#.###.#.#.#####.#.#####.#.#####.###.#####.#.#######.#######.#######.###.#.#####.#####.###.###.#.###.#.###.#.#.###.###.#.#.###########.###
#.#.#.....#.#.....#.#.#.....#.#...#...#.....#...#.......#.....#.....###.....#.#...#...#...#...#...#...#.#...#...#...#.....#...#...#.....#...#
#.#.#######.#####.#.#.#.#####.#.#.###.#####.#####.#######.###.#####.#########.#.#.###.#.###.###.#####.#.###.#######.###########.#.#.###.###.#
#.#.#.......#...#.#...#.......#.#.....#...#.....#.....#...#...#...#.......#...#.#.#...#...#.#...#...#.#.#...#.......#...#...#...#...###...#.#
#.#.#.#######.#.#.#############.#######.#.#####.#####.#.###.###.#.#######.#.###.#.#.#####.#.#.###.#.#.#.#.###.#######.#.#.#.#.###########.#.#
#...#.#...#...#...#.............#...#...#.#...#...#...#.#...#...#.....#...#...#.#.#.....#...#...#.#.#.#.#.#...#...#...#.#.#.#...........#.#.#
#####.#.#.#.#######.#############.#.#.###.#.#.###.#.###.#.###.#######.#.#####.#.#.#####.#######.#.#.#.#.#.#.###.#.#.###.#.#.###########.#.#.#
#.....#.#.#.......#.............#.#.#.#...#.#.#...#.....#...#.......#.#.#.....#.#.......#.......#.#.#.#...#.....#.#.###...#...#...#...#.#.#.#
#.#####.#.#######.#############.#.#.#.#.###.#.#.###########.#######.#.#.#.#####.#########.#######.#.#.###########.#.#########.#.#.#.#.#.#.#.#
#.#...#.#.#...#...#.............#.#.#.#.....#.#...#.........#.......#...#.#...#.......#...#.....#.#.#.....#.......#.........#...#...#.#.#.#.#
#.#.#.#.#.#.#.#.###.#############.#.#.#######.###.#.#########.###########.#.#.#######.#.###.###.#.#.#####.#.###############.#########.#.#.#.#
#.#.#.#.#.#.#...###.......#.......#.#.....###.....#.........#.....###...#...#.#.....#.#...#.#...#.#.#...#.#...#.....#.....#.........#.#.#.#.#
#.#.#.#.#.#.#############.#.#######.#####.#################.#####.###.#.#####.#.###.#.###.#.#.###.#.#.#.#.###.#.###.#.###.#########.#.#.#.#.#
#.#.#.#.#.#...#...........#.....#...#...#.....#.............#...#...#.#.#...#.#.#...#...#...#...#.#.#.#.#.#...#.#...#...#.#.........#...#.#.#
#.#.#.#.#.###.#.###############.#.###.#.#####.#.#############.#.###.#.#.#.#.#.#.#.#####.#######.#.#.#.#.#.#.###.#.#####.#.#.#############.#.#
#.#.#.#.#...#.#...#...#...#...#.#.#...#.#...#.#...#.....#...#.#...#...#...#.#.#.#...#...#.......#.#.#.#.#.#.#...#...#...#.#...........#...#.#
#.#.#.#.###.#.###.#.#.#.#.#.#.#.#.#.###.#.#.#.###.#.###.#.#.#.###.#########.#.#.###.#.###.#######.#.#.#.#.#.#.#####.#.###.###########.#.###.#
#...#...###...###...#...#...#...#...###...#...###...###...#...###...........#...###...###.........#...#...#...#####...###.............#.....#
#############################################################################################################################################
"""

TEST = """
###############
#...#...#.....#
#.#.#.#.#.###.#
#S#...#.#.#...#
#######.#.#.###
#######.#.#...#
#######.#.###.#
###..E#...#...#
###.#######.###
#...###...#...#
#.#####.#.###.#
#.#...#.#.#...#
#.#.#.#.#.#.###
#...#...#...###
###############
"""


x = TEST
x = PROD
x = x.strip()

# Data in differnt formats for quick access
text = x
lines = x.split("\n")
grid = [list(line) for line in lines]

start = None
end = None

for x in range(len(grid)):
    for y in range(len(grid[x])):
        if grid[x][y] == "S":
            start = (x, y)
        if grid[x][y] == "E":
            end = (x, y)


def print_grid(grid):
    for line in grid:
        print("".join(line))


# we need to find the all paths from start to end
# however, we can "cheat" and disable walls for 2 steps


# use bfs to find all paths


def draw(grid, VIZ, current=None, skipped=None):
    for x in range(len(grid)):
        line = ""
        for y in range(len(grid[x])):
            if (x, y) in VIZ:
                line += colored(grid[x][y], "red")
            elif (x, y) == current:
                line += colored(grid[x][y], "green")
            elif (x, y) == skipped:
                line += colored(grid[x][y], "yellow")
            else:
                line += grid[x][y]
        print(line)

    input()


# WE WILL DO BFS AND FIND COSTS

q = [start]
visited = set()
costs = {start: 0}

print("Doing BFS")
while q:
    current = q.pop(0)

    if current in visited:
        continue

    visited.add(current)

    x, y = current

    if grid[x][y] == "#":
        continue

    if current == end:
        continue

    for dx, dy in [(0, 1), (0, -1), (1, 0), (-1, 0)]:
        new_x = x + dx
        new_y = y + dy

        if new_x < 0 or new_y < 0 or new_x >= len(grid) or new_y >= len(grid[0]):
            continue

        if (new_x, new_y) in visited:
            continue

        q.append((new_x, new_y))

        if (new_x, new_y) not in costs:
            costs[(new_x, new_y)] = costs[current] + 1
        else:
            costs[(new_x, new_y)] = min(costs[(new_x, new_y)], costs[current] + 1)


print("Done BFS")
normal_cost = costs[end]

print(normal_cost)

cheats = []

print("Finding Cheats")

to_check = list(costs.keys())
for i in tqdm(range(len(to_check))):
    for j in range(i + 1, len(to_check)):
        p1 = to_check[i]
        p2 = to_check[j]
        if p1 == p2:
            continue

        # is distance between p1 and p2 is 2
        x1, y1 = p1
        x2, y2 = p2
        dist = abs(x1 - x2) + abs(y1 - y2)

        if dist > 20:
            continue

        is_wall_between_points = False

        if grid[x1][y1] == "#" or grid[x2][y2] == "#":
            continue

        for x in range(min(x1, x2), max(x1, x2) + 1):
            for y in range(min(y1, y2), max(y1, y2) + 1):
                if grid[x][y] == "#":
                    is_wall_between_points = True
                    break

            if is_wall_between_points:
                break

        if is_wall_between_points:
            # we can technically jump from p1 to p2
            # how much will this save?
            savings = abs(costs[p1] - costs[p2]) - dist
            if savings >= 100:
                cheats.append((p1, p2, savings))


print([x for x in cheats if x[2] == 38][:5])

r = Counter([x[2] for x in cheats])
for key in sorted(r.keys()):
    print(key, r[key])

print(len(cheats))
